---
import { GoogleTagmanagerPartytown } from '@digi4care/astro-google-tagmanager'
import { ClientRouter } from 'astro:transitions'
import defaultImage from '../images/tempHero.jpg?url'
import { getPayload } from '../payload'
import Head from './Head.astro'

type Props = {
  title?: string
  description?: string
  image?: string
  video?: string
} & Parameters<typeof Head>['0']

const payload = await getPayload()

const config = await payload.findGlobal({ slug: 'site-settings' })
const { description = config.description, image = defaultImage } = Astro.props

const menuTitle = Astro.props.title

const title =
  !menuTitle || Astro.url.pathname === '/'
    ? `${Astro.props.title || config.title} | ${config.subtitle}`
    : `${menuTitle} | ${config.title}`
---

<Head pageTitle={title} description={description} path={Astro.url.pathname} />

<GoogleTagmanagerPartytown id={config.googleAnalytics} />

<ClientRouter />
